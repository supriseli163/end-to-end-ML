# End-to-End Deep Learning for Person Search
Author:Tong Xiao(香港中文大学)
#摘要
现有的行人辨识和基准和算法主要聚焦于在查询和候选集之间匹配裁剪的行人图像。
但是，它与现实世界的场景不同，在这些场景中，行人边界框的注视不可用，并且需要从整个图像中找到目标任务。
为了缩小差距，我们研究如何在不依赖候选框的情况下从场景图像本地化和匹配查询人员。
我们提出了一个端到端的深度学习框架来共同处理这项任务，而不是将其分解为两个单独的任务-行人检测和行人识别。
我们提出了随机抽样softmax损失，以在稀疏和不平衡标签的监督下有效地训练模型。另一方面，现有的基准测试规模很小，而且样本
是从几个固定的摄像机视图中收集的，场景多样性较低，为了解决整个问题，我们收集了一个大规模和场景多样化的人物搜索数据，其中包含了18184个图像，8432个人和99809
个标注的边界框，我们在建议的数据集上评估我们的方法和其他基准线，并研究各种因素的影响。实验表面，我们的方法取得了很好的表现。
# 1.介绍

  行人重识别目标是跨摄像机匹配行人图像。它是一个快速发展的研究领域[41,18,20]，在视频监控和多媒体方面有许多重要应用，例如行人检索[22]，跨摄像机视觉跟踪[34]和活动分析[36,由于
姿势、灯光、遮挡、分辨率、背景杂乱和相机设置的复杂变化，这个问题尤其具有许多挑战性。尽管近年来已经提出了许多重新数据集和算法，并且这些基准的性能已经大大提高，但是与实际应用仍存在很大的差距.查询人员与图库中
手动裁剪的行人相匹配，而不是从整个图像中搜索目标人物，根据这些基准的协议，开发的re-id算法假设完美的行人检测，但是在真实场景中无法获得行人边界框和边界的注释。
现有的行人检测器将不可避免地产生误差，错误检测和错位，这可能会损害识别的结果]在这种情况下，目前的reid算法不能直接应用与真实的监控系统。
因此，提出有效和准确的人员搜索算法来解决整个问题是迫切和重要的，即搜索整个图像中的目标人员，这比现有的基准测试提出的挑战更加困难。在第一个检测步骤中可能会遗漏一些目标。因此，基于这些基准，无法充分研究大量误报和
检测带来的挑战。

为了缩小传统的person re-id研究和应用之间的差距，我们研究了如何在不依赖候选候选集注释的情况下从场景图像本地化和匹配查询人员。
不同于卷积方法把行人搜索问题分成了两个独立的任务-行人检测和行人识别，我们提出了一种端到端的深度学习框架来来共同应对来自两方面的挑战。联合优化了
带来了诸多优势，例如，学习的检测器可以允许一些可以通过重新识别来轻松处理的错误告警，同时专注于其他硬件样本。另一方面，检测和person re-id模块可以更好地相互配合，以减少检测不准确的对结果的影响。我们共享了一个完全卷积神经网络,以提取行人特征和产生具有判别力的行人辨识特征。提出了随机抽样softmax损失，以便在稀疏和不平衡标签的监督下有效滴训练模型。

据我们所知，现有的基准测试规模较小，样本是从几个固定的摄像机中收集的，这些视图具有较低的场景多样性。为了证明我们提出的管道并未社区服务，我们收集了一个大规模多样化的任务搜索数据集。它包括18184个图像和8432个查询人。它们是从街道和电影快照中的数百个场景中收集的。我们手动注释每个图像的所有人，产生99809个边界框，并在不同的图像中匹配同一个人，如下图所示：

本文的贡献总结为三个部分

- 1.我们提出了一种端到端的深度学习框架，用于从图库中的整个图像中搜索查询人，这更接近实际应用。我们不是简单地将行人检测和行人识别重新组合在一起，而是在一个统一的过程中优化这两个共同目标，提出了一种训练策略来有效地训练模型，实验结果表明我们的框架优于其他的方法。
- 2.我们收集了一个由于人物搜索的大型基准数据集，涵盖了包括街道、电影快照的数百个场景，还提供了丰富的注释和协议，以促进和测试模型的实验。数据集和代码将向公共开源。
- 3.在我们数据集上建立了一套基准，包括我们的方法和性能，以及其他行人检测和行人辨识基准。我们还根据经验研究各种因素的影响，包括检测和召回、图库大小、遮挡和分辨率。
# 2.相关工作

# 3.行人搜索新的基准
# 4.端到端的行人搜索方法
# 5.实验
为了研究多种因素对人物搜索的影响并证明我们提出的方法的有效性，我们在新的基准上进行了几组实验。在本节中，我们首先在51.节中详细介绍了基线方法和实验设置。然后在5.2节中通过单独检测和重新评估来评估基线。在5.3节中介绍了我们方法的有效性，在5.4节中进行了对比测试。最后我们介绍了各种因素的影响，包括检测召回、图库大小、人物遮挡和图像分辨率。

  